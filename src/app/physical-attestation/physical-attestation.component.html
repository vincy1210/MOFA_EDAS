<!-- <app-loader></app-loader> -->
<div>
  <div class="grid grid-cols-1" color="primary" class="page-header">
    <h3>
      {{ "label.physicalAttestDetails.mainpage.title" | translate }}
    </h3>
  </div>
  <div class="company-bg physicalAttestDetails-page">
    <div class="mx-auto physicalAttestDetails-window">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
        <div
          class="bg-white rounded-lg p-5 col-span-3"
          [ngClass]="{ 'col-span-2': shouldShow, 'col-span-3': !shouldShow }"
        >
          <!-- <div class="grid grid-cols-1 add-button">
            <button mat-button (click)="openDialogAttest()">
              <mat-icon>add</mat-icon>
              {{ "label.physicalAttestDetails.addAttest" | translate }}
            </button>
          </div> -->
          <p-table
            [(selection)]="selectedAttestations"
            dataKey="attestationrequno"
            [scrollable]="true"
            selectionMode="multiple"
            #tableref
            [rowHover]="true"
            [paginator]="true"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [filterDelay]="0"
            [totalRecords]="totalrecords"
            [value]="invoiceRequestLists"
            [rows]="10"
            [columns]="cols"
            [showCurrentPageReport]="true"
            [rowsPerPageOptions]="[10, 25, 50]"
            [loading]="loading"
            styleClass="p-datatable-customers p-datatable-gridlines"
            currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
            [globalFilterFields]="[
              'edasreqno',
              'entitycode',
              'invoiceno',
              'invoiceamount',
              'invoicecurrency',
              'invoicedate'
            ]"
          >
            <ng-template pTemplate="caption">
              <div class="p-d-flex grid-header">
                <div class="grid-header-left">
                  <span class="p-input-icon-left p-ml-auto grid-search">
                    <i class="pi pi-search"></i>
                    <input
                      pInputText
                      type="text"
                      (input)="
                        tableref.filterGlobal(
                          $any($event.target).value,
                          'contains'
                        )
                      "
                      placeholder="Search keyword"
                    />
                  </span>
                </div>
                <div class="grid-header-right">
                  <button
                    type="button"
                    pButton
                    pRipple
                    icon="pi pi-file-excel"
                    (click)="exportExcel()"
                    class="mr-2 grid-header-right-icon"
                    [pTooltip]="'label.excelExport' | translate"
                    tooltipPosition="bottom"
                  ></button>
                  <button
                    type="button"
                    pButton
                    pRipple
                    icon="pi pi-filter"
                    (click)="clickChips()"
                    class="mr-2 grid-header-right-icon"
                    [ngClass]="{ clicked: enableFilters }"
                    [pTooltip]="'label.filter' | translate"
                    tooltipPosition="bottom"
                  ></button>
                  <button
                    type="button"
                    pButton
                    pRipple
                    icon="pi pi-plus"
                    (click)="openDialogAttest()"
                    class="mr-2 grid-header-right-icon"
                    [pTooltip]="
                      'label.physicalAttestDetails.addAttest' | translate
                    "
                    tooltipPosition="bottom"
                  ></button>
                </div>
              </div>
            </ng-template>
            <ng-template pTemplate="header" let-columns>
              <tr>
                <th style="width: 3rem">
                  <p-tableHeaderCheckbox (click)="loadsidepanel($event)">
                  </p-tableHeaderCheckbox>
                </th>
                <th *ngFor="let col of columns" [pSortableColumn]="col.field">
                  {{ col.header | translate }}
                  <p-sortIcon field="code" *ngIf="enableFilters"></p-sortIcon>
                  <p-columnFilter
                    type="text"
                    [field]="col.field"
                    display="menu"
                    *ngIf="enableFilters"
                  ></p-columnFilter>
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-data>
              <tr>
                <td>
                  <p-tableCheckbox
                    (click)="loadsidepanel($event)"
                    [value]="data"
                  ></p-tableCheckbox>
                </td>
                <td>
                  <span class="image-text">{{ data.edasreqno }}</span>
                </td>
                <td>
                  <span class="image-text">{{ data.entitycode }}</span>
                </td>
                <td>
                  <span class="image-text">{{ data.invoiceno }}</span>
                </td>
                <td>
                  <span class="image-text">{{ data.invoiceamount }}</span>
                </td>
                <td>
                  <span class="image-text">{{ data.invoicecurrency }}</span>
                </td>
                <td>
                  <span class="image-text">{{
                    splitdatetime1(data.invoicedate)?.date
                  }}</span>
                </td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                <td colspan="10">{{ "noDataFound" | translate }}</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
        <div
          class="bg-white rounded-lg p-5 mofa-tab-section show"
          [ngClass]="{ show: shouldShow, hide: !shouldShow }"
        >
          <mat-tab-group>
            <mat-tab label="Timeline" *ngIf="true">
              <div class="grid grid-cols-1">
                <div class="dw-container mt-5">
                  <div class="timeline-block timeline-block-right current">
                    <div class="marker"></div>
                    <div class="timeline-content">
                      <div class="float-left ml-3">
                        <div class="grid grid-cols-1">
                          <div class="w-100">
                            <mat-chip-list>
                              <h6 class="al-title">
                                <span>CREATED</span><mat-icon>check</mat-icon>
                              </h6>
                            </mat-chip-list>
                          </div>
                          <small
                            ><strong>{{ "createddate" }}</strong></small
                          >
                          <small>{{ "createdTime" }}</small>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="timeline-block timeline-block-right active">
                    <div class="marker"></div>
                    <div class="timeline-content">
                      <div class="float-left ml-3">
                        <div class="grid grid-cols-1">
                          <div class="w-100">
                            <mat-chip-list>
                              <h6 class="al-title">
                                <span>APPROVED</span><mat-icon>check</mat-icon>
                              </h6>
                            </mat-chip-list>
                          </div>
                          <small
                            ><strong>{{ "approveddate" }}</strong></small
                          >
                          <small>{{ "approvedTime" }}</small>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="timeline-block timeline-block-right active">
                    <div class="marker"></div>
                    <div class="timeline-content">
                      <div class="float-left ml-3">
                        <div class="grid grid-cols-1">
                          <div class="w-100">
                            <mat-chip-list>
                              <h6 class="al-title">
                                <span>PAYMENT</span>
                                <!-- <mat-icon>check</mat-icon> -->
                              </h6>
                            </mat-chip-list>
                          </div>
                          <small
                            ><strong>{{ "paymentdate" }}</strong></small
                          >
                          <small>{{ "paymentTime" }}</small>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="timeline-block timeline-block-right current">
                    <div class="marker"></div>
                    <div class="timeline-content">
                      <div class="float-left ml-3">
                        <div class="grid grid-cols-1">
                          <div class="w-100">
                            <mat-chip-list>
                              <h6 class="al-title">
                                <span>ATTESTATION</span>
                                <!-- <mat-icon>check</mat-icon> -->
                              </h6>
                            </mat-chip-list>
                          </div>
                          <small
                            ><strong>{{ "attestationdate" }}</strong></small
                          >
                          <small>{{ "attestationTime" }}</small>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="timeline-block timeline-block-right">
                    <div class="marker"></div>
                    <div class="timeline-content">
                      <div class="float-left ml-3">
                        <div class="grid grid-cols-1">
                          <div class="w-100">
                            <mat-chip-list>
                              <h6 class="al-title">
                                <span>COMPLETED</span>
                                <!-- <mat-icon>check</mat-icon> -->
                              </h6>
                            </mat-chip-list>
                          </div>
                          <small
                            ><strong>{{ "completedDate" }}</strong></small
                          >
                          <small>{{ "completedTime" }}</small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </mat-tab>
            <mat-tab label="Payment">
              <div class="grid grid-cols-1">
                <br />
                <br />
                <div class="Frame-18799">
                  <div class="row">
                    <div class="col-8">
                      <mat-label>No. of Invoices selected</mat-label>
                    </div>
                    <div class="col-4">
                      {{ "noOfInvoicesSelected" }}
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-8">
                      <mat-label>Total Fines(0)</mat-label>
                    </div>
                    <div class="col-4">
                      {{ "totalFineAmount" }}
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-8">
                      <mat-label>Attestation Fees</mat-label>
                    </div>
                    <div class="col-4">
                      {{ "totalAttestationFee" }}
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-6"></div>
                    <div class="col-6">
                      <mat-label style="font-size: 18px"
                        >Total Amount</mat-label
                      >
                      <br />
                      <br />
                      <mat-label style="font-size: 25px"
                        >AED {{ "totalFee" }}</mat-label
                      >
                      <br />
                      <!-- <mat-label style="text-align: left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </mat-label>  -->

                      <span style="font-size: 10px">incl.VAT</span>
                    </div>
                  </div>
                  <div class="row">
                    <button mat-flat-button color="primary">pay</button>
                  </div>
                  <div style="text-align: center; font-size: 10px">
                    <span>Powered by</span>&nbsp;<span
                      style="color: rgb(4, 60, 76)"
                      >Magnati</span
                    >
                  </div>
                </div>
              </div>
            </mat-tab>
            <mat-tab *ngIf="true" label="Preview">
              <div class="grid grid-cols-1">
                <p *ngIf="true">Loading...</p>

                <!-- <div id="pdfContainer"></div> -->
                <div id="outerContainer">
                  <div class="pdf-container">
                    <pdf-viewer
                      [rotation]="0"
                      [original-size]="false"
                      [show-all]="true"
                      [fit-to-page]="false"
                      [zoom]="1"
                      [zoom-scale]="'page-width'"
                      [stick-to-page]="false"
                      [render-text]="true"
                      [external-link-target]="'blank'"
                      [autoresize]="true"
                      [show-borders]="false"
                      style="width: 100%; height: 600px"
                    ></pdf-viewer>
                  </div>
                </div>
              </div>
            </mat-tab>
          </mat-tab-group>
        </div>
      </div>
    </div>
  </div>
</div>
